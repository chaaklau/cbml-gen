<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CBML Generator</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- Prism CSS for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <!-- Custom Styles -->
    <link href="styles.css" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="app-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1><i class="bi bi-diagram-3 me-3"></i>CBML Generator</h1>
                    <p>Comic Book Markup Language Generator and Analyzer</p>
                </div>
                <div class="col-md-4 text-end">
                    <nav>
                        <ul class="nav nav-pills justify-content-end">
                            <li class="nav-item">
                                <a class="nav-link active" href="#" data-page="about">
                                    <i class="bi bi-info-circle me-1"></i>About
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#" data-page="annotate">
                                    <i class="bi bi-pencil-square me-1"></i>Annotate
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#" data-page="analysis">
                                    <i class="bi bi-graph-up me-1"></i>Analysis
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="page-container">
        <div class="container-fluid">
            
            <!-- About Page -->
            <div id="about" class="page active">
                <div class="about-page">
                    <div class="text-center mb-5">
                        <h2 class="display-4 mb-3">Welcome to CBML Generator</h2>
                        <p class="lead">A comprehensive tool for annotating comic strips using the Comic Book Markup Language (CBML) scheme and analyzing the resulting data.</p>
                    </div>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="bi bi-pencil-square"></i>
                            </div>
                            <h4>Interactive Annotation</h4>
                            <p>Easily annotate comic panels with characters, transitions, and attentional framing using an intuitive interface. Add balloons, captions, and custom elements with just a few clicks.</p>
                        </div>

                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="bi bi-graph-up"></i>
                            </div>
                            <h4>Statistical Analysis</h4>
                            <p>Upload your CBML XML files to generate comprehensive statistical analyses with interactive charts and visualizations of character appearances, transitions, and framing techniques.</p>
                        </div>
                    </div>

                    <div class="card mt-5">
                        <div class="card-header">
                            <h4><i class="bi bi-book me-2"></i>About CBML</h4>
                        </div>
                        <div class="card-body">
                            <p>
                                The Comic Book Markup Language (CBML) is a specialized markup scheme designed for the digital annotation 
                                and analysis of comic books and graphic narratives. This tool implements the CBML specification to help 
                                researchers, educators, and enthusiasts systematically annotate comic content.
                            </p>
                            <p>
                                For more information about the CBML markup scheme, visit: 
                                <a href="https://dcl.luddy.indiana.edu/cbml/" target="_blank" class="fw-bold">
                                    https://dcl.luddy.indiana.edu/cbml/
                                </a>
                            </p>
                            <div class="mt-4">
                                <h5>Key Features:</h5>
                                <ul class="list-unstyled">
                                    <li><i class="bi bi-check-circle-fill text-success me-2"></i>Panel-level annotation</li>
                                    <li><i class="bi bi-check-circle-fill text-success me-2"></i>Character tracking</li>
                                    <li><i class="bi bi-check-circle-fill text-success me-2"></i>Transition classification</li>
                                    <li><i class="bi bi-check-circle-fill text-success me-2"></i>Attentional framing analysis</li>
                                    <li><i class="bi bi-check-circle-fill text-success me-2"></i>Speech balloon annotation</li>
                                    <li><i class="bi bi-check-circle-fill text-success me-2"></i>Caption and custom element support</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="card mt-4">
                        <div class="card-header">
                            <h4><i class="bi bi-person-heart me-2"></i>Acknowledgements</h4>
                        </div>
                        <div class="card-body">
                            <p class="mb-0">
                                This CBML Generator was created by <strong>Chaak-ming Lau</strong> to support the teaching of the course 
                                <strong>CUS4020 Digital Humanities</strong> at <strong>The Education University of Hong Kong</strong>.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Annotate Page -->
            <div id="annotate" class="page">
                <div class="row g-4">
                    <div class="col-lg-7">
                        <div class="generator-panel">
                            <h2 class="mb-4"><i class="bi bi-pencil-square me-2"></i>Panel Annotation</h2>
                            
                            <div class="card mb-4">
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="storyid" class="form-label fw-bold">Story ID</label>
                                        <input type="text" id="storyid" class="form-control" placeholder="Enter story ID (required)">
                                        <div class="form-text">A unique identifier for your comic story or chapter.</div>
                                    </div>
                                </div>
                            </div>

                            <div id="panelGrpContainer" class="mb-4">
                                <!-- Panel groups will be added here dynamically -->
                            </div>

                            <div class="text-center">
                                <button id="addPanelGrpBtn" class="btn btn-primary btn-lg">
                                    <i class="bi bi-plus-circle me-2"></i>Add Panel Group
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-5">
                        <div class="output-panel">
                            <h2 class="mb-4"><i class="bi bi-code-slash me-2"></i>Generated XML</h2>
                            <div class="card">
                                <div class="card-body">
                                    <pre id="output" class="mb-0"><i id="copyBtn" class="bi bi-clipboard" title="Copy to clipboard"></i><i id='saveBtn' class="bi bi-download me-1"></i><code class="language-xml"></code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analysis Page -->
            <div id="analysis" class="page">
                <h2 class="mb-4"><i class="bi bi-graph-up me-2"></i>CBML Analysis</h2>
                
                <div class="analysis-controls">
                    <h4>Load XML File for Analysis</h4>
                    <p class="text-muted">Upload your CBML XML file or load the default sample to generate statistical analysis and visualizations.</p>
                    
                    <div class="d-flex gap-3 flex-wrap">
                        <button class="btn btn-primary" onclick="analyzer.loadDefaultXML()">
                            <i class="bi bi-file-earmark-text me-2"></i>Load Default XML
                        </button>
                        <div>
                            <input type="file" id="fileInput" accept=".xml" onchange="analyzer.loadUserXML(event)" style="display:none;">
                            <button class="btn btn-outline-primary" onclick="document.getElementById('fileInput').click()">
                                <i class="bi bi-upload me-2"></i>Upload XML File
                            </button>
                        </div>
                        <button class="btn btn-outline-secondary" onclick="analyzer.clearResults()">
                            <i class="bi bi-x-circle me-2"></i>Clear Results
                        </button>
                    </div>
                </div>

                <div id="analysisOutput">
                    <!-- Analysis results will be displayed here -->
                    <div class="text-center text-muted py-5">
                        <i class="bi bi-graph-up" style="font-size: 4rem; opacity: 0.3;"></i>
                        <p class="mt-3">Load an XML file to begin analysis</p>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js for visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <!-- Prism JS for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
    
    <!-- Application Scripts -->
    <script src="app.js"></script>
    <script src="analysis.js"></script>
</body>
</html>